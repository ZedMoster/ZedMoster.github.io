{"meta":{"title":"é¾™|Engineer|BIMer","subtitle":"è½¨è¿¹","description":"è®°å½•å­¦ä¹ è½¨è¿¹","author":"é¾™","url":"https://zedmoster.github.io","root":"/"},"pages":[{"title":"about","date":"2021-02-07T16:00:00.000Z","updated":"2021-02-08T20:03:27.623Z","comments":true,"path":"about/index.html","permalink":"https://zedmoster.github.io/about/index.html","excerpt":"","text":"ä¸“ä¸šï¼šåœŸæœ¨å·¥ç¨‹ï¼ˆ2017ï¼‰ èŒä¸šï¼šè½¯ä»¶å·¥ç¨‹å¸ˆã€å»ºç­‘è®¾è®¡å¸ˆ å­¦ä¹ ï¼šBIMã€pythonã€C#"},{"title":"categories","date":"2021-02-08T08:34:08.000Z","updated":"2021-02-08T11:26:23.807Z","comments":true,"path":"categories/index.html","permalink":"https://zedmoster.github.io/categories/index.html","excerpt":"","text":""},{"title":"search","date":"2021-02-08T08:34:16.000Z","updated":"2021-02-08T11:32:16.602Z","comments":true,"path":"search/index.html","permalink":"https://zedmoster.github.io/search/index.html","excerpt":"","text":""},{"title":"tags","date":"2021-02-08T08:33:55.000Z","updated":"2021-02-08T11:26:16.317Z","comments":true,"path":"tags/index.html","permalink":"https://zedmoster.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"2.13 æç¤º TaskDialog","slug":"PythonScriptPrimer/2.13 æç¤ºTaskDialog","date":"2021-02-09T00:08:19.000Z","updated":"2021-02-08T20:40:22.276Z","comments":true,"path":"2021/02/09/PythonScriptPrimer/2.13 æç¤ºTaskDialog/","link":"","permalink":"https://zedmoster.github.io/2021/02/09/PythonScriptPrimer/2.13%20%E6%8F%90%E7%A4%BATaskDialog/","excerpt":"","text":"åˆ›å»º TaskDialogTaskDialogs æ˜¯ Revit ä¸­çš„ç”¨äºæä¾›è¯¦ç»†çš„ç”¨æˆ·åé¦ˆ API ç±»ã€‚å®ƒä»¬å¯ä»¥ç”¨ä¸€è¡Œä»£ç æ‰§è¡Œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1TaskDialog.Show(&quot;Example Title&quot;, &quot;Example Text&quot;) TaskDialogs å¯ç”¨äºå‘ç”¨æˆ·æä¾›ä¸€å®šç¨‹åº¦çš„åé¦ˆï¼Œå¯èƒ½æ—¶æƒ³æŠ¥å‘Šè„šæœ¬æ˜¯æˆåŠŸè¿è¡Œè¿˜æ˜¯é‡åˆ°ä»€ä¹ˆé”™è¯¯ç­‰æƒ…å†µã€‚ è‡ªå®šä¹‰ TaskDialogTaskDialog ä¹Ÿå¯ä»¥é€šè¿‡ç±»çš„å±æ€§å¯¹å…¶è¿›è¡Œç¼–è¾‘ï¼Œä»¥ä½¿å†…å®¹æ›´åŠ ä¸°å¯Œï¼Œä¾‹å¦‚ï¼š 1234567task_dialog = TaskDialog(&quot;Example Title&quot;)task_dialog.CommonButtons = TaskDialogCommonButtons.Cancel | TaskDialogCommonButtons.Ok | TaskDialogCommonButtons.Close | TaskDialogCommonButtons.No | TaskDialogCommonButtons.Yes | TaskDialogCommonButtons.Retry | TaskDialogCommonButtons.Nonetask_dialog.FooterText = &quot;Example Footer Text&quot;task_dialog.MainInstruction = &quot;Example Main Instruction&quot;task_dialog.MainContent = &quot;This is the main content for this TaskDialog&quot;task_dialog.Show() æç¤ºçª—å£æ ·å¼","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"2.12 å†…ç½®ç±»åˆ«","slug":"PythonScriptPrimer/2.12 å†…ç½®ç±»åˆ«","date":"2021-02-09T00:08:18.000Z","updated":"2021-02-08T20:37:04.254Z","comments":true,"path":"2021/02/09/PythonScriptPrimer/2.12 å†…ç½®ç±»åˆ«/","link":"","permalink":"https://zedmoster.github.io/2021/02/09/PythonScriptPrimer/2.12%20%E5%86%85%E7%BD%AE%E7%B1%BB%E5%88%AB/","excerpt":"","text":"BuiltInCategoryRevit ç”¨æˆ·ç•Œé¢å‘ç”¨æˆ·æ˜¾ç¤ºäº†è®¸å¤šç±»åˆ«ï¼Œä¾‹å¦‚é—¨ï¼Œæ¥¼æ¿å’Œå¸¸è§„æ¨¡å‹ç­‰ã€‚Revit åœ¨å†…éƒ¨ä½¿ç”¨æ›´è¯¦ç»†çš„ç±»åˆ«åˆ—è¡¨ï¼Œç§°ä¸ºå†…ç½®ç±»åˆ«ã€‚å†…ç½®ç±»åˆ«çš„å®Œæ•´åˆ—è¡¨å¯ä»¥åœ¨ BuiltInCategory æšä¸¾ä¸­æ‰¾åˆ°-è¿™äº›æ˜¯å›ºå®šç¼–ç ï¼Œä¸èƒ½åˆ›å»ºä¿®æ”¹ã€‚ æ£€ç´¢ç±»åˆ«å…ƒç´ ç”±äºè¯¥åˆ—è¡¨æ¶µç›–äº†è¿‘ 1000 ä¸ªç±»åˆ«ï¼Œå› æ­¤å¯ä»¥å¸®åŠ©æˆ‘é—¨æ›´ç²¾ç¡®åœ°å®šä½ Revit å…ƒç´ ã€‚å†…ç½®ç±»åˆ«å¯¹äº FilteredElementCollectors å°¤å…¶æœ‰ç”¨ï¼Œå®ƒä½¿æˆ‘ä»¬èƒ½å¤Ÿå‡†ç¡®æ£€ç´¢ç‰¹å®šçš„å…ƒç´ ã€‚ ä¾‹å¦‚ï¼Œè¦æ”¶é›†æ–‡æ¡£ä¸­çš„æ‰€æœ‰ é¢ç§¯æ ‡ç­¾ ï¼š 12area_tags = FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_AreaTags).ToElements()OUT = area_tags","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"2.11 Units å•ä½å¤„ç†","slug":"PythonScriptPrimer/2.11 Unitså•ä½å¤„ç†","date":"2021-02-09T00:08:17.000Z","updated":"2021-02-08T20:36:44.474Z","comments":true,"path":"2021/02/09/PythonScriptPrimer/2.11 Unitså•ä½å¤„ç†/","link":"","permalink":"https://zedmoster.github.io/2021/02/09/PythonScriptPrimer/2.11%20Units%E5%8D%95%E4%BD%8D%E5%A4%84%E7%90%86/","excerpt":"","text":"Revit é•¿åº¦Revit é•¿åº¦å†…éƒ¨å•ä½ï¼šè‹±å°º 123detail_line = UnwrapElement(IN[0])decimal_feet_length = detail_line.GeometryCurve.LengthOUT = decimal_feet_length # å•ä½ï¼šè‹±å°º ä¸Šé¢ä»£ç è¿”å›çš„æ•°æ®å•ä½å¹¶ä¸æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„æ¯«ç±³å•ä½ï¼Œæ‰€ä»¥éœ€è¦å¯¹æ•°æ®è¿›è¡Œå•ä½è½¬æ¢ã€‚ å•ä½è½¬æ¢ï¼ˆæ¯«ç±³ï¼‰ä½¿ç”¨ Revit çš„ UnitUtils ç±»ï¼Œä¸”å‚æ•°åªèƒ½ä» Revit çš„ DisplayUnitType æšä¸¾ä¸­é€‰æ‹©å€¼ç±»å‹ 1234detail_line = UnwrapElement(IN[0])decimal_feet_length = detail_line.GeometryCurve.Lengthmetric_length = UnitUtils.Convert(decimal_feet_length, DisplayUnitType.DUT_DECIMAL_FEET, DisplayUnitType.DUT_MILLIMETERS) # å°†è‹±å°ºè½¬æ¢ä¸ºæ¯«ç±³OUT = metric_length # å•ä½ï¼šæ¯«ç±³ è§’åº¦å•ä½è½¬æ¢ï¼ˆå¼§åº¦ï¼‰Revit è§’åº¦å†…éƒ¨å•ä½ï¼šå¼§åº¦ 123angle = 90.0 # è§’åº¦å€¼radians_equivalent = UnitUtils.Convert(angle, DisplayUnitType.DUT_DECIMAL_DEGREES, DisplayUnitType.DUT_RADIANS) # å°†è§’åº¦è½¬æ¢ä¸ºå¼§åº¦OUT = radians_equivalent # å•ä½ï¼šå¼§åº¦","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"2.10 æç¤ºç”¨æˆ·ç•Œé¢é€‰æ‹©","slug":"PythonScriptPrimer/2.10 æç¤ºç”¨æˆ·ç•Œé¢é€‰æ‹©","date":"2021-02-09T00:08:16.000Z","updated":"2021-02-08T20:36:20.795Z","comments":true,"path":"2021/02/09/PythonScriptPrimer/2.10 æç¤ºç”¨æˆ·ç•Œé¢é€‰æ‹©/","link":"","permalink":"https://zedmoster.github.io/2021/02/09/PythonScriptPrimer/2.10%20%E6%8F%90%E7%A4%BA%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E9%80%89%E6%8B%A9/","excerpt":"","text":"ç”¨æˆ·é€‰æ‹©å·¥ä½œæµç¨‹æœ‰æ—¶æˆ‘ä»¬å¯èƒ½ä¼šæ„å»ºä¸€ä¸ªé€šç”¨å·¥å…·ï¼Œè¦æ±‚ç”¨æˆ·é€‰æ‹©æ–‡æ¡£ä¸­çš„ Revit å…ƒç´ ï¼ˆä¾‹å¦‚ï¼Œå…ƒç´ é‡æ–°ç¼–å·å·¥å…·ï¼‰ã€‚è¿™å°†éœ€è¦æ— é™æ•°é‡çš„å¯è‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼Œä»¥ä½¿ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨é€»è¾‘é€‰æ‹©ä»–ä»¬é€‰æ‹©çš„å…ƒç´ ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æç¤ºç”¨æˆ·é€‰æ‹©æŸäº›å†…å®¹æ¥è·³è¿‡æ•´ä¸ªé—®é¢˜ã€‚ ISelectionFilter æ¥å£ISelectionFilter å¯ä»¥é™åˆ¶ç”¨æˆ·å¯ä»¥é€‰æ‹©çš„å…ƒç´ ç§ç±»ã€‚åªéœ€è¦åˆ›å»ºä¸€ä¸ªå®ç°è¯¥æ¥å£çš„æ–°ç±»ã€‚ ç„¶åï¼Œå°†æ­¤ç±»çš„å®ä¾‹ä½œä¸ºå‚æ•°æä¾›ç»™ PickElementsByRectangle() æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œæç¤ºç”¨æˆ·é€‰æ‹© Walls æ‰€éœ€çš„ä»£ç ä¸ºï¼š 123456789101112131415# åŠ è½½è¿‡æ»¤é€‰æ‹©çš„æ¥å£ ISelectionFilterfrom Autodesk.Revit.UI.Selection import ISelectionFilter# å®šä¹‰é€‰æ‹©è¿‡æ»¤å™¨class MySelectionFilter(ISelectionFilter): def __init__(self): pass def AllowElement(self, element): return element.Category.Name == &quot;å¢™&quot; def AllowReference(self, element): return Falseselection_filter = MySelectionFilter() # ä»…é€‰æ‹©å¢™walls = uidoc.Selection.PickElementsByRectangle(selection_filter) # è¿”å›æ¡†é€‰çš„å¢™ä½“OUT = walls","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"2.9 æ‰¹å¤„ç†æ–‡æ¡£","slug":"PythonScriptPrimer/2.9 æ‰¹å¤„ç†æ–‡æ¡£","date":"2021-02-09T00:08:15.000Z","updated":"2021-02-08T20:36:01.174Z","comments":true,"path":"2021/02/09/PythonScriptPrimer/2.9 æ‰¹å¤„ç†æ–‡æ¡£/","link":"","permalink":"https://zedmoster.github.io/2021/02/09/PythonScriptPrimer/2.9%20%E6%89%B9%E5%A4%84%E7%90%86%E6%96%87%E6%A1%A3/","excerpt":"","text":"æ‰¹å¤„ç† Revit æ–‡ä»¶ Revit API çš„æœ€å¼ºå¤§åŠŸèƒ½ä¹‹ä¸€å°±æ˜¯èƒ½å¤Ÿä»¥è‡ªåŠ¨æ–¹å¼æ‰“å¼€ï¼Œå…³é—­ï¼Œç¼–è¾‘å’Œä¿å­˜æ–‡æ¡£ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥â€œæ— å¤´â€å®ç°è¿™ä¸€ç›®æ ‡ï¼Œè¿™æ„å‘³ç€æ— éœ€ä»»ä½• GUI ç»„ä»¶å³å¯æ‰“å¼€ Revit æ–‡æ¡£çš„æ•°æ®åº“ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œä»¥è¿™ç§æ–¹å¼å¤„ç†æ–‡æ¡£å¯èƒ½æ¯”ç”¨æˆ·è¿™æ ·åšå¿« 20 åˆ° 30 å€-è¿™æ„å‘³ç€æ„å»ºæ¶‰åŠå¿«é€Ÿæ‰¹å¤„ç†è®¸å¤šæ–‡ä»¶æ—¶å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚ æ‰¹å¤„ç†æ­¥éª¤ï¼š æ ¹æ®ç›®æ ‡æ–‡æ¡£çš„æ–‡ä»¶è·¯å¾„ï¼Œåˆ›å»º Revit FilePath å¯¹è±¡çš„åˆ—è¡¨ï¼Œéå†æ­¤æ–‡æ¡£è·¯å¾„åˆ—è¡¨ ä½¿ç”¨ Revit API çš„ Open() æ–¹æ³•æ‰“å¼€æ–‡ä»¶å¹¶ä¸ºæ­¤æ‰“å¼€çš„æ–‡æ¡£åˆ›å»ºä¸€ä¸ªå¥æŸ„ é€šè¿‡å…¶å¥æŸ„æ‰“å¼€é’ˆå¯¹æˆ‘ä»¬æ–°æ‰“å¼€çš„æ–‡æ¡£çš„å¤„ç† æ ¹æ®éœ€æ±‚è¿›è¡Œ API è°ƒç”¨ï¼Œå…·ä½“å–å†³äºè¦æ‰§è¡Œçš„å…·ä½“æ“ä½œ å…³é—­æ‰“å¼€æ–‡æ¡£ã€‚å¦‚æœéœ€è¦ä¿å­˜æ›´æ”¹ï¼Œå¯å°†æ–‡æ¡£è¿›è¡Œå¦å­˜ã€‚ python èŠ‚ç‚¹ä»£ç 123456789101112131415input_paths = IN[0]# è®¾ç½®æ‰“å¼€æ–¹å¼open_options = OpenOptions()report = []for path in input_paths: filepath = FilePath(path) # æ‰“å¼€æ–‡ä»¶ family_doc = app.OpenDocumentFile(filepath, open_options) dimensions = FilteredElementCollector(family_doc).OfCategory(BuiltInCategory.OST_Dimensions).WhereElementIsNotElementType().ToElements() number_dimensions = len(dimensions) report.append(&quot;File &#123;&#125; contains &#123;&#125; dimensions&quot;.format(path, number_dimensions)) # å…³é—­æ–‡ä»¶ family_doc.Close(False)OUT = report #Outputting the report we generated dynamo èŠ‚ç‚¹","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"2.8 å¤„ç†äº‹åŠ¡ Transactions","slug":"PythonScriptPrimer/2.8 å¤„ç†äº‹åŠ¡ Transactions","date":"2021-02-09T00:08:14.000Z","updated":"2021-02-08T20:35:45.647Z","comments":true,"path":"2021/02/09/PythonScriptPrimer/2.8 å¤„ç†äº‹åŠ¡ Transactions/","link":"","permalink":"https://zedmoster.github.io/2021/02/09/PythonScriptPrimer/2.8%20%E5%A4%84%E7%90%86%E4%BA%8B%E5%8A%A1%20Transactions/","excerpt":"","text":"Revit æ˜¯æ•°æ®åº“éœ€è¦å¯¹è¯¥æ•°æ®åº“çš„æ›´æ”¹è¿›è¡Œä»”ç»†çš„æ’åºï¼Œéœ€è¦å¯¹è¿‡ç¨‹è¿›è¡Œç®¡ç†å’Œæ£€æŸ¥ï¼ˆé’ˆå¯¹æ¶æ„çš„æœ‰æ•ˆæ€§ä»¥åŠé’ˆå¯¹ Revit API è®¾è®¡çš„åˆæ³•æ€§ï¼‰ã€‚æ‰€æœ‰è¿™äº›éƒ½ç”± Revit çš„æœ¬æœº Transaction API å¤„ç†ã€‚ Dynamoâ€™s TransactionManagerå½“ç›´æ¥ä¸º Revit API ç¼–ç æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ä»£ç å®ä¾‹åŒ– Transaction ç±»çš„æ–°å¯¹è±¡å¹¶è°ƒç”¨å…¶ Start() æ–¹æ³•æ¥ç®€å•åœ°å¯åŠ¨æ–°äº‹åŠ¡ã€‚ä½†æ˜¯ï¼Œåœ¨ Dynamo ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ä¸‹é¢è¿™ç§æ–¹å¼è¿›è¡Œå¤„ç†ã€‚ TransactionManager æ˜¯ Dynamo API çš„ä¸€éƒ¨åˆ†ï¼Œè¯¥ API å¤„ç† Dynamo åº”ç”¨ç¨‹åºä¸­å¯¹ Revit æ–‡æ¡£æ•°æ®åº“æ‰€åšçš„æ›´æ”¹ï¼š 1234TransactionManager.Instance.EnsureInTransaction(doc) # ä¸º doc æ–‡æ¡£å¼€å¯äº‹åŠ¡# å¢ã€åˆ ã€æ”¹æ“ä½œRevitæ–‡æ¡£TransactionManager.Instance.TransactionTaskDone() # æäº¤æ›´æ–° ç®€è€Œè¨€ä¹‹ï¼Œä¸»ä½“ä»£ç éƒ½å†™åœ¨æ ·æ¿ä»£ç çš„è¿™ä¸¤è¡Œä»£ç ä¹‹é—´å³å¯ã€‚","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"2.7 è®¿é—®å›¾å…ƒå‚æ•° Parameters","slug":"PythonScriptPrimer/2.7 è®¿é—®å›¾å…ƒå‚æ•° Parameters","date":"2021-02-09T00:08:13.000Z","updated":"2021-02-08T20:35:15.734Z","comments":true,"path":"2021/02/09/PythonScriptPrimer/2.7 è®¿é—®å›¾å…ƒå‚æ•° Parameters/","link":"","permalink":"https://zedmoster.github.io/2021/02/09/PythonScriptPrimer/2.7%20%E8%AE%BF%E9%97%AE%E5%9B%BE%E5%85%83%E5%8F%82%E6%95%B0%20Parameters/","excerpt":"","text":"æ—ã€æ—ç±»å‹ã€æ—å®ä¾‹ä¹‹é—´çš„å…³ç³»Revit çš„æ—ç³»ä½¿ç”¨æ—ç±»å‹å’Œæ—å®ä¾‹ä¹‹é—´çš„å±‚æ¬¡å…³ç³»ã€‚API ä¸­å¹¶è¡Œå­˜åœ¨ç›¸åŒçš„å…³ç³»ï¼š æ—å®ä¾‹ æ˜¯ Revit çš„ FamilyInstance ç±»çš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼šé¡¹ç›®ä¸­åˆ›å»ºçš„é—¨ã€çª— æ—ç±»å‹ æ˜¯ Revit çš„ FamilyType ç±»çš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼šé˜²ç«é—¨ FM1822 ç±»å‹ æ—å®ä¾‹å‚æ•°é€šè¿‡ FamilyInstance å¯¹è±¡è®¿é—®ï¼Œè€Œæ—ç±»å‹çš„å‚æ•°é€šè¿‡å®ä¾‹çš„ FamilyType ç±»å‹å¯¹è±¡è®¿é—®ã€‚ åŒ…å«å…³ç³»ï¼šFamilyInstance -&gt; FamilyType -&gt; Family æ¯ä¸ªFamilyInstanceéƒ½æ˜¯é€šè¿‡FamilyTypeåˆ›å»ºã€‚åŒæ ·ï¼Œæ¯ä¸ªFamilyTypeå°†ç”±é¡¹ç›®æ–‡æ¡£ä¸­çš„åŠ è½½çš„Familyæ—æ–‡ä»¶å®šä¹‰ã€‚ ä¸‹é¢æ¼”ç¤ºå¦‚ä½•ä»FamilyInstanceå‘ä¸Šæ‰¾åˆ°FamilyTypeç±»å‹ï¼Œå†é€šè¿‡FamilyTypeæ‰¾åˆ°Familyæ—ï¼š 12345family_instance = UnwrapElement(IN[0]) # å±•å¼€dynamoå›¾å…ƒå¾—åˆ°Revitæ—å®ä¾‹family_type_id = family_instance.GetTypeId() # è·å–æ—å®ä¾‹çš„ç±»å‹Idfamily_type = doc.GetElement(family_type_id) # é€šè¿‡ç±»å‹Idè·å–æ—ç±»å‹family = family_type.Family # é€šè¿‡ç±»å‹è·å–æ—FamilyOUT = family_instance, family_type, family # è¾“å‡º [æ—å®ä¾‹, æ—ç±»å‹, æ—] åæ–¹å‘æŸ¥æ‰¾ï¼šFamilyå¯¹è±¡é€šå¸¸åŒ…å«å¤šä¸ªçš„FamilyTypeå¯¹è±¡ä¹‹é—´å­˜åœ¨å¤šå¯¹ä¸€çš„å…³ç³»ã€‚åŒæ ·ï¼Œæœ‰è®¸å¤šæ”¾ç½®ç›¸åŒFamilyTypeçš„FamilyInstancesã€‚è¦è·å¾—ä¸€ä¸ªå®¶åº­çš„æ‰€æœ‰ family_typeï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š 1234family = UnwrapElement(IN[0]) # å±•å¼€dynamoå›¾å…ƒå¾—åˆ°Revitæ—family_type_ids = family.GetFamilySymbolIds() # è·å–æ—åŒ…å«çš„æ‰€æœ‰ç±»å‹Idfamily_types = [doc.GetElement(id) for id in family_type_ids] # è·å–æ‰€æœ‰çš„æ—ç±»å‹å­˜å†åˆ—è¡¨ä¸­OUT = family_types # è¾“å‡ºæ—ç±»å‹åˆ—è¡¨ å¯»æ‰¾ç‰¹å®šç±»å‹çš„æ‰€æœ‰FamilyInstanceå¯¹è±¡æ˜¯é‚£ä¹ˆç®€å•-æˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ª FamilyInstanceFilter ä½¿ç”¨æ‰€éœ€FamilyTypeçš„ IDã€‚ 12345678910111213141516# å±•å¼€dynamoå›¾å…ƒå¾—åˆ°Revitæ—family = UnwrapElement(IN[0])# è·å–æ—åŒ…å«çš„æ‰€æœ‰ç±»å‹Idfamily_type_ids = family.GetFamilySymbolIds()# åˆ›å»ºæ—å®ä¾‹åˆ—è¡¨family_instances = []# å¯»æ‰¾ç±»å‹å¯¹åº”çš„å®ä¾‹for family_type_id in family_type_ids: # åˆ›å»ºæŒ‡å®šç±»å‹çš„è¿‡æ»¤å™¨ family_instance_filter = FamilyInstanceFilter(doc, family_type_id) # è·å–æ–‡æ¡£ä¸­æ‰€æœ‰ç±»å‹çš„å®ä¾‹å¯¹è±¡ elements = FilteredElementCollector(doc).WherePasses(family_instance_filter).ToElements() # å°†å®ä¾‹å¯¹è±¡æ·»åŠ åˆ°åˆ—è¡¨ family_instances.append(elements)# è¾“å‡ºç»“æœOUT = family_instances æ—å®ä¾‹å’Œæ—ç±»å‹å‚æ•°è·å–æ—å®ä¾‹å‚æ•°å¦‚æœè¦ä¸ä¼ é€’ Dynamo å…ƒç´ åˆ°èŠ‚ç‚¹ä¸­ä¸ Revit å…ƒç´ è¿›è¡Œäº¤äº’ï¼Œåˆ™éœ€è¦å°†å…¶å±•å¼€ã€‚å±•å¼€åï¼Œå¯ä»¥è®¿é—®ç‰¹å®šå‚æ•°å°†æ‰€æœ‰å…ƒç´ å®ä¾‹å‚æ•°çš„åˆ—è¡¨ä½œä¸º Parameter å¯¹è±¡è¿”å›ï¼Œå¯ä»¥é€šè¿‡å…¶ Element.Parameters å±æ€§è®¿é—®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12family_instance = UnwrapElement(IN[0]) # æ—å®ä¾‹å¯¹è±¡instance_parameters = family_instance.Parameters # å®ä¾‹åŒ…å«çš„æ‰€æœ‰å‚æ•° è·å–æ—ç±»å‹å‚æ•°ç±»å‹å‚æ•°éœ€è¦é€šè¿‡å…ƒç´ çš„æ—ç±»å‹æ¥è®¿é—®ã€‚å¦‚æœå°†FamilyInstanceä½œä¸ºè¾“å…¥ï¼Œåˆ™é¦–å…ˆéœ€è¦è·å–å…ƒç´ çš„ FamilyType å¯¹è±¡ï¼Œä¾‹å¦‚ GetTypeId() æ­¤æ–¹æ³•è¿”å›å…ƒç´ çš„æ—ç±»å‹çš„ElementIdã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ doc.GetElement() æ–¹æ³•è¿”å›å…ƒç´ çš„FamilyTypeå¯¹è±¡ã€‚ 123family_instance = UnwrapElement(IN[0]) # æ—å®ä¾‹å¯¹è±¡family_type = doc.GetElement(family_instance.GetTypeId()) # é€šè¿‡å®ä¾‹è·å–ç±»å‹type_parameters = family_type.Parameters # ç±»å‹åŒ…å«çš„æ‰€æœ‰å‚æ•° è®¿é—®æŒ‡å®šå‚æ•°å¯¹äºè·å– FamilyInstance æˆ– FamilyType çš„å‚æ•°ï¼Œæœ‰ä»¥ä¸‹æ–¹æ³•æ¥è®¿é—®ç‰¹å®šå‚æ•°ï¼š Element.LookupParameter() Element.get_Parameter() è¿™ä¸¤ç§æ–¹æ³•æœ¬è´¨ä¸Šéƒ½æ˜¯ç›¸åŒçš„ã€‚å®ƒä»¬è¿”å›ä¸€ä¸ª Parameter å¯¹è±¡ã€‚é€‰æ‹© Revit é—¨å®ä¾‹å¯¹è±¡ï¼š è·å–å‚æ•°å€¼12input_element = UnwrapElement(IN[0])paratemer = input_element.LookupParameter(&quot;é¡¶é«˜åº¦&quot;) å¦‚æœè¾“å‡ºåŸå§‹Parameterå¯¹è±¡ï¼Œå®ƒå°†æ˜¾ç¤ºä¸ºAutodesk.Revit.DB.Parameterï¼Œä¸ºäº†è·å–å‚æ•° Parameter å¯¹è±¡çš„å€¼ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ Parameter ç±»çš„å¯¹å…¶è¿›è¡Œè½¬æ¢ã€‚ ä¾æ®åˆ¤æ–­å€¼çš„ç±»å‹è¿›è¡Œå–å€¼å³å¯ï¼š AsDouble() AsElementId() AsInteger() AsString() AsValueString() ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•ä»¥é€‚å½“çš„æ•°æ®ç±»å‹è¿”å›å€¼ã€‚ 12input_element = UnwrapElement(IN[0])value = input_element.LookupParameter(&quot;é¡¶é«˜åº¦&quot;).AsValueString() # value = 2400 æ­¤å·¥ä½œæµç¨‹ç­‰æ•ˆäºåœ¨ Dynamo ä¸­ä½¿ç”¨ GetParameterValueByName èŠ‚ç‚¹ã€‚ è®¾ç½®å‚æ•°å€¼åŒæ ·éœ€è¦è·å–åˆ°Parameterå¯¹è±¡ï¼Œä½¿ç”¨ Set() æ–¹æ³•è¿›è¡Œèµ‹å€¼å³å¯,å½“ç„¶æ›´æ”¹å‚æ•°çš„è¿™ä¸ªæ“ä½œä¿®æ”¹äº†æ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥åº”è¯¥å¼€å¯ Transaction äº‹åŠ¡ã€‚ ã€‚ 1234TransactionManager.Instance.EnsureInTransaction(doc) # äº‹åŠ¡å¼€å§‹input_element = UnwrapElement(IN[0])input_element.LookupParameter(&quot;é¡¶é«˜åº¦&quot;).Set(2000)TransactionManager.Instance.TransactionTaskDone() # äº‹åŠ¡ç»“æŸ Set å€¼å¯¹è±¡çš„ç±»å‹åŒ…æ‹¬ï¼š Set(float) Set(int) Set(ElementId) Set(str)","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"2.6 å‡ ä½•(Geometry)è½¬æ¢","slug":"PythonScriptPrimer/2.6 å‡ ä½•(Geometry)è½¬æ¢","date":"2021-02-09T00:08:12.000Z","updated":"2021-02-08T20:35:05.332Z","comments":true,"path":"2021/02/09/PythonScriptPrimer/2.6 å‡ ä½•(Geometry)è½¬æ¢/","link":"","permalink":"https://zedmoster.github.io/2021/02/09/PythonScriptPrimer/2.6%20%E5%87%A0%E4%BD%95(Geometry)%E8%BD%AC%E6%8D%A2/","excerpt":"","text":"Revit å‡ ä½•å›¾å½¢å’Œ Dynamo å‡ ä½•å›¾å½¢Dynamo å…·æœ‰ä¸ Revit å¹¶è¡Œçš„ç±»åº“ã€‚æ„å‘³ç€éœ€è¦ä½¿ç”¨ç‰¹æ®Šçš„è½¬æ¢æ–¹æ³•æ¥ä½¿ä¸¤è€…ä¹‹é—´è¿›è¡Œè½¬æ¢å®ç°æ•°æ®äº¤äº’ã€‚å‰é¢ç« èŠ‚ä¹Ÿæåˆ°è¿‡éœ€è¦å±•å¼€å¯¹è±¡ã€‚ è½¬æ¢æ–¹å¼æ‚¨å¯ä»¥ä½¿ç”¨ Dynamo API çš„è½¬æ¢æ–¹æ³•è½»æ¾åœ°åœ¨ Dynamo å’Œ Revit å‡ ä½•ç±»å‹ä¹‹é—´è¿›è¡Œåˆ‡æ¢: ToProtoType() ToDSType() ToLine() ToPoint() ToVector() ToXyz() PointsRevit ç‚¹åœ¨ 3D ç©ºé—´ä¸­ç”±å…¶ Xï¼ŒY å’Œ Z åæ ‡å®šä¹‰ã€‚åˆ›å»ºæ–¹æ³•ï¼šå…ˆåˆ›å»ºç‚¹çš„å¯¹è±¡ Autodesk.Revit.DB.XYZï¼Œåœ¨åˆ›å»º Revit ç‚¹ Autodesk.Revit.DB.Point.Create æ–¹æ³•åˆ›å»ºï¼Œè¯¥æ–¹æ³•éœ€è¦ä¼ å…¥ç‚¹çš„å¯¹è±¡ã€‚ 12XYZ revit_xyz = new Autodesk.Revit.DB.XYZ(0,0,0) // åˆ›å»ºç‚¹å¯¹è±¡Point revit_point = Autodesk.Revit.DB.Point.Create(revit_xyz) // åˆ›å»ºç‚¹ è¦åˆ›å»º Dynamo ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ Designscript åº“ï¼Œè¯¥åº“æ˜¯ Dynamo çš„ä¸€éƒ¨åˆ†ã€‚Dynamo ç‚¹çš„ç±»å‹ä¸º Autodesk.DesignScript.Geometry.Point å¦‚æœä» Python èŠ‚ç‚¹è¾“å‡ºä»¥ä¸‹ dynamo_pointï¼Œå®ƒå°†ç«‹å³æ˜¾ç¤ºåœ¨ Dynamo çš„ 3D èƒŒæ™¯é¢„è§ˆä¸­ã€‚ 12dynamo_point = Autodesk.DesignScript.Geometry.Point.ByCoordinates(0,0,0) # åˆ›å»ºç‚¹OUT = dynamo_point # è¾“å‡ºç‚¹è§†å›¾å°†æ˜¾ç¤º æ³¨æ„ï¼šå³ä½¿æˆ‘ä»¬åœ¨è¿™é‡Œåˆ›å»º Revit å¯¹è±¡ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¹Ÿä¸éœ€è¦å°†å®ƒä»¬åŒ…è£…åœ¨ Transaction äº‹åŠ¡ä¸­ã€‚ 1234revit_xyz = Autodesk.Revit.DB.XYZ(0,0,0) # Revit XYZ# ä½¿ç”¨XYZå¯¹è±¡åˆ›å»ºç‚¹revit_point = Autodesk.Revit.DB.Point.Create(revit_xyz)OUT = revit_xyz, revit_point æˆ‘ä»¬å¯ä»¥ä» Python è„šæœ¬èŠ‚ç‚¹è¾“å‡º XYZ å’Œ Pointï¼Œä½†æ˜¯é™¤éå°†å®ƒä»¬è½¬æ¢ä¸º Dynamo ç±»å‹ï¼Œå¦åˆ™å®ƒä»¬å°†åœ¨ Dynamo å‡ ä½•é¢„è§ˆä¸­ä¸å¯è§ï¼š ToPoint() ToProtoType() 123revit_xyz = Autodesk.Revit.DB.XYZ(0,0,0)revit_point = Autodesk.Revit.DB.Point.Create(revit_xyz)OUT = revit_xyz.ToPoint(), revit_point.ToProtoType() Lines / Curvesâ€‹â€‹ å…ˆçœ‹ä¸€ä¸‹ Dynamo ç±»ï¼šDynamo æœ‰ä¸¤ä¸ªçº¿å‹å‡ ä½•ç±»ã€‚äº†è§£ä»–ä»¬ä¹‹é—´å­˜åœ¨åŒºåˆ«ã€‚ Autodesk.DesignScript.Geometry.Line çº¿æ®µï¼Œå…·æœ‰èµ·ç‚¹å’Œç»ˆç‚¹ã€‚ Autodesk.DesignScript.Geometry.Curve å¤æ‚çš„æ›²é¢æˆ– UV åæ ‡ã€‚Dynamo çš„ Curve ç±»åŒ…å« Line ã€‚ ä¸ºäº†ä½¿è¿™ä¸ªç¤ºä¾‹ç®€å•ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢æ˜¾ç¤ºå¦‚ä½•åˆ›å»ºä¸€æ¡ç®€å•çš„ Dynamo è¡Œã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†åˆ›å»º Dynamo ç‚¹ï¼Œç„¶åå°†å…¶ç”¨ä½œå®šä¹‰ç›´çº¿çš„èµ·ç‚¹å’Œç»ˆç‚¹ã€‚ 1234dynamo_point_1 = Autodesk.DesignScript.Geometry.Point.ByCoordinates(0,0,0) # åˆ›å»ºèµ·ç‚¹dynamo_point_2 = Autodesk.DesignScript.Geometry.Point.ByCoordinates(10,10,0) # åˆ›å»ºç»ˆç‚¹dynamo_line = Autodesk.DesignScript.Geometry.Line.ByStartPointEndPoint(dynamo_point_1, dynamo_point_2) # ä¼ å…¥å‚æ•°èµ·ç‚¹å’Œç»ˆç‚¹åˆ›å»ºDynamoçº¿æ®µOUT = dynamo_line # è¿”å›çº¿æ®µ ä¸‹é¢å°è¯•ä½¿ç”¨ python è„šæœ¬èŠ‚ç‚¹è¾“å‡ºï¼Œå¹¶ä½¿ç”¨ ToProtoType() å°†å…¶è½¬æ¢ä¸º Dynamo å‡ ä½•ç±»å‹ï¼Œå¦åˆ™åœ¨ Dynamo å‡ ä½•é¢„è§ˆä¸­å°†ä¸å¯è§ã€‚ 1234revit_xyz_1 = XYZ(0,0,0)revit_xyz_2 = XYZ(10,10,0)revit_line = Line.CreateBound(revit_xyz_1, revit_xyz_2)OUT = revit_line.ToProtoType()","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"2.5 è¿‡æ»¤å™¨ FilteredElementCollector","slug":"PythonScriptPrimer/2.5 è¿‡æ»¤å™¨ FilteredElementCollector","date":"2021-02-09T00:08:11.000Z","updated":"2021-02-08T20:35:02.526Z","comments":true,"path":"2021/02/09/PythonScriptPrimer/2.5 è¿‡æ»¤å™¨ FilteredElementCollector/","link":"","permalink":"https://zedmoster.github.io/2021/02/09/PythonScriptPrimer/2.5%20%E8%BF%87%E6%BB%A4%E5%99%A8%20FilteredElementCollector/","excerpt":"","text":"ä»‹ç»å¤„ç†æ¨¡å‹çš„å‰ææ˜¯è·å–åˆ°ç›¸åº”ç±»å‹çš„å…ƒç´ ã€‚Revit çš„ FilteredElementCollector å…è®¸æ‚¨ä½¿ç”¨ä¸€ç»„è‡ªå®šä¹‰çš„è¿‡æ»¤è§„åˆ™ï¼Œåœ¨ Revit æ–‡æ¡£çš„æ•°æ®åº“ä¸­å¿«é€Ÿæœç´¢å…ƒç´ ã€‚æ‚¨å¯ä»¥å°†æœç´¢è¿‡æ»¤å™¨å’Œä¿®é¥°ç¬¦å †å åœ¨ä¸€èµ·ï¼Œä»è€Œä½¿æ‚¨å¯ä»¥è¿›è¡Œå‡ ä¹æ— é™æ¬¡çš„è‡ªå®šä¹‰æœç´¢ã€‚ ä¸¾ä¸ªç®€å•çš„ä¾‹å­FilteredElementCollectors å°†è¿”å› Element æˆ– ElementIds çš„åˆ—è¡¨ã€‚ å¿«é€Ÿç»„åˆåœ¨ä¸€èµ·éå¸¸ç®€å•ã€‚ä¾‹å¦‚ï¼š 12345all_furniture = FilteredElementCollector(doc) # åˆ›å»ºè¿‡æ»¤å™¨all_furniture.OfCategory(BuiltInCategory.OST_Furniture) # è¿‡æ»¤å®¶å…·ï¼ˆåŒ…å«ï¼šå®ä¾‹å’Œç±»å‹ï¼‰all_furniture.WhereElementIsNotElementType() # è¿‡æ»¤é¡¹ç›®ä¸­å®¶å…·å®ä¾‹all_furniture.ToElements() # ç»“æœè½¬æ¢ä¸ºElementå¯¹è±¡åˆ—è¡¨OUT = all_furniture # è¾“å‡ºå¯¹è±¡ è¿™æ®µä»£ç é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„ FilteredElementCollector å®ä¾‹ï¼Œè¯¥å®ä¾‹å°† Revit æ–‡æ¡£ä½œä¸ºå…¶æ„é€ å‡½æ•°ä¸­çš„å‚æ•°ã€‚ ç¬¬ 4 è¡Œæ·»åŠ äº†ä¸€ä¸ªè¿›ä¸€æ­¥çš„è¿‡æ»¤å™¨-æˆ‘ä»¬ä¸æƒ³åœ¨è¿”å›çš„å…ƒç´ ä¸­ä»…åŒ…å«å®¶å…·æ—ç±»å‹ï¼Œè€Œä»…æ˜¯å®ä¾‹ã€‚ åœ¨ç¬¬ 5 è¡Œä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šæˆ‘ä»¬å¸Œæœ› FilteredElementCollector è¿”å›å®é™…çš„ Revit å…ƒç´ ã€‚ æœ€åï¼Œç¬¬ 6 è¡Œä½¿ç”¨ OUT ä»èŠ‚ç‚¹è¾“å‡ºæ”¶é›†çš„å…ƒç´ ã€‚ ä¹Ÿå¯ä»¥å°†ä¸Šè¿°è„šæœ¬å‹ç¼©ä¸ºä¸€è¡Œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12all_furniture = FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Furniture).WhereElementIsNotElementType().ToElements()OUT = all_furniture è¿™ä¸¤ä¸ªè„šæœ¬å°†è¿”å›å®Œå…¨ç›¸åŒçš„å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥é€‰æ‹©ä½¿ç”¨å“ªä¸ªç‰ˆæœ¬:è¾ƒé•¿çš„ç‰ˆæœ¬è¿˜æ˜¯è¾ƒå†—é•¿çš„ç‰ˆæœ¬ å»ºè®®ä½¿ç”¨ä¸‹é¢è¿™ç§ç®€æ´ è¿‡æ»¤å™¨ä½¿ç”¨æŒ‡å—å…³äºå¦‚ä½•ä¸ºå…ƒç´ ç»„è£…åŸºæœ¬è¿‡æ»¤å™¨çš„åˆ†æ­¥æŒ‡å—ï¼š çŸ¥é“æ‚¨è¦è¿‡æ»¤çš„å†…å®¹ å¦‚æœè¿™æ˜¯ Revit ç±»åˆ«çš„å…ƒç´ ï¼Œè¯·åœ¨ BuiltInCategory æšä¸¾ä¸­æ‰¾åˆ°ç­‰æ•ˆçš„ BuiltInCategory ç±»å‹ã€‚ å¦åˆ™ï¼Œå¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾ç‰¹å®š API ç±»çš„å…ƒç´ ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ .OfClass() è¿‡æ»¤å™¨ï¼Œå¹¶åœ¨ Class åç§°ä¸­æ·»åŠ ä¸€ä¸ªå‚æ•°ç±»åˆ«ã€‚ æ‚¨æ˜¯å¦è¦è¿”å›å…ƒç´ å®ä¾‹æˆ–å…¶ç±»å‹ ä¾‹å¦‚ï¼Œæ‚¨è¦æŸ¥æ‰¾æ–‡æ¡£ä¸­çš„æ‰€æœ‰ TextNotes å®ä¾‹è¿˜æ˜¯æ‰€æœ‰ TextNoteTypes æ—ç±»å‹ å¦‚æœéœ€è¦å®ä¾‹ï¼Œè¯·ä½¿ç”¨ .WhereElementIsNotElementType() è¿‡æ»¤å™¨ å¦‚æœéœ€è¦ç±»å‹ï¼Œè¯·ä½¿ç”¨ .WhereElementIsElementType() è¿‡æ»¤å™¨ å¦‚æœæ‚¨ä¸¤è€…éƒ½æƒ³è¦ï¼Œåˆ™ä¸è¦ä½¿ç”¨è¿‡æ»¤å™¨ æ˜¯å¦è¦è¿”å› Revit å…ƒç´ æˆ–å…ƒç´ çš„ ID ä½¿ç”¨ .ToElements() æˆ– .ToElementIds() å®Œæˆæ‚¨çš„ FilteredElementCollector æŸ¥è¯¢ã€‚ è¿›é˜¶ç­›é€‰ä¸Šé¢æ˜¯æ„å»ºåŸºæœ¬ FilteredElementCollector çš„å¤§è‡´æŒ‡å—ã€‚ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥æ„å»ºæ›´å¤šè‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼š æ‚¨å¯ä»¥ä½¿ç”¨ ElementLevelFilter æ¥è¿‡æ»¤æŸä¸ªçº§åˆ«ä¸Šæ‰˜ç®¡çš„å…ƒç´ ï¼Œæˆ–è€…ä½¿ç”¨ ElementWorksetFilter æ¥ä»…è¿‡æ»¤ç‰¹å®šå·¥ä½œé›†ä¸Šçš„å…ƒç´ ã€‚ æ‚¨å¯ä»¥å»ºç«‹è‡ªå®šä¹‰è¯„ä¼°è§„åˆ™ã€‚æ˜¯å¦ä»…åœ¨æŒ‡å®šå‚æ•°å€¼æˆ– Height å‚æ•°å¤§äº 3000mm çš„å…ƒç´ ä¸­å¯»æ‰¾å…ƒç´ ï¼Ÿè¿™äº›éƒ½æ˜¯å¯ä»¥è½»æ¾å®ç°çš„ã€‚ æ­¤é¡µé¢åªæ˜¯åˆ®æ“¦ FilteredElementCollectors çš„è¡¨é¢ã€‚ å¿«é€Ÿè¿‡æ»¤å™¨-QuickFilters ElementCategoryFilter ï¼šä¸è¾“å…¥ç±»åˆ« ID åŒ¹é…çš„å…ƒç´ ï¼› å¿«æ·æ–¹å¼ï¼šOfCategory ElementClassFilterï¼šä¸è¾“å…¥è¿è¡Œæ—¶ç±»åŒ¹é…çš„å…ƒç´ ï¼› å¿«æ·æ–¹å¼ï¼šOfClass ElementIsElementTypeFilterï¼šæ˜¯â€œå…ƒç´ ç±»å‹â€ï¼ˆç¬¦å·ï¼‰çš„å…ƒç´ ï¼› å¿«æ·æ–¹å¼ï¼šWhereElementIsElementType / WhereElementIsNotElementType ElementOwnerViewFilterï¼šç‰¹å®šäºè§†å›¾çš„å…ƒç´ ï¼› å¿«æ·æ–¹å¼ï¼šOwnedByView / WhereElementIsViewIndependent ElementDesignOptionFilterï¼šç‰¹å®šè®¾è®¡é€‰é¡¹ä¸­çš„å…ƒç´ ï¼› å¿«æ·æ–¹å¼ï¼šContainedInDesignOption ElementIsCurveDrivenFilterï¼šæ›²çº¿é©±åŠ¨çš„å…ƒç´ ï¼› å¿«æ·æ–¹å¼ï¼šWhereElementIsCurveDriven ElementStructuralTypeFilterï¼šåŒ¹é…ç»™å®šç»“æ„ç±»å‹çš„å…ƒç´  FamilySymbolFilterï¼šç‰¹å®šå®¶åº­çš„ç¬¦å· ExclusionFilterï¼šé™¤è¾“å…¥åˆ°è¿‡æ»¤å™¨ä¸­çš„å…ƒç´  ID ä¹‹å¤–çš„æ‰€æœ‰å…ƒç´  BoundingBoxIntersectsFilterï¼šå…·æœ‰ä¸ç»™å®šè½®å»“ç›¸äº¤çš„è¾¹ç•Œæ¡†çš„å…ƒç´  BoundingBoxIsInsideFilterï¼šåœ¨ç»™å®šè½®å»“å†…å…·æœ‰è¾¹ç•Œæ¡†çš„å…ƒç´  BoundingBoxContainsPointFilterï¼šå…·æœ‰åŒ…å«ç»™å®šç‚¹çš„è¾¹ç•Œæ¡†çš„å…ƒç´ ","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"2.3 äº†è§£ Doc, UIDoc, App, UIApp","slug":"PythonScriptPrimer/2.3 äº†è§£ Doc, UIDoc, App, UIApp","date":"2021-02-09T00:08:10.000Z","updated":"2021-02-08T20:33:36.090Z","comments":true,"path":"2021/02/09/PythonScriptPrimer/2.3 äº†è§£ Doc, UIDoc, App, UIApp/","link":"","permalink":"https://zedmoster.github.io/2021/02/09/PythonScriptPrimer/2.3%20%E4%BA%86%E8%A7%A3%20Doc,%20UIDoc,%20App,%20UIApp/","excerpt":"","text":"æ ·æ¿ä»£ç æ­£å¦‚åœ¨æ ·æ¿ä»£ç ä¸€ç« ä¸­æ‰€è§ï¼ŒRevit æ ·æ¿ä»£ç é€šå¸¸éœ€è¦è®¾ç½® Revit åº”ç”¨ç¨‹åºå’Œæ–‡æ¡£ docï¼Œuidocï¼Œappï¼Œuiappçš„å¥æŸ„ã€‚ ä½†æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ Application and Documentä¸€å¼€å§‹ï¼ŒAPI çš„è¿™ä¸€éƒ¨åˆ†ä¼¼ä¹æœ‰äº›æ··ä¹±ã€‚é—®é¢˜æ¯”æ¯”çš†æ˜¯ï¼šRevit ä¸èƒ½ä»…ç®—å‡ºæˆ‘æ‰€å¤„çš„æ–‡æ¡£ï¼ˆå³æ¨¡å‹ï¼‰å—ï¼Ÿä¸ºä»€ä¹ˆæˆ‘æœ‰ä¸€ä¸ª Document å’Œä¸€ä¸ª UIDocumentï¼Ÿä¸ºä»€ä¹ˆè¦å¼•ç”¨åº”ç”¨ç¨‹åº-åº”ç”¨ç¨‹åºä¸æ˜¯ Revit å—ï¼Ÿ è¿™äº›æ˜¯å¾ˆå¥½çš„é—®é¢˜ã€‚å¹¸è¿çš„æ˜¯ï¼ŒRevit çš„ API æŒ‡å—ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€äº›ç­”æ¡ˆï¼š Revit Platform API ä¸­çš„é¡¶çº§å¯¹è±¡æ˜¯åº”ç”¨ç¨‹åºå’Œæ–‡æ¡£ã€‚è¿™äº›ç”±ç±» Applicationï¼ŒUIApplicationï¼ŒDocument å’Œ UIDocument è¡¨ç¤ºã€‚ åº”ç”¨ç¨‹åºå¯¹è±¡å¼•ç”¨ä¸€ä¸ªå•ç‹¬çš„ Revit ä¼šè¯ æä¾›å¯¹æ–‡æ¡£ï¼Œé€‰é¡¹ä»¥åŠå…¶ä»–åº”ç”¨ç¨‹åºèŒƒå›´çš„æ•°æ®å’Œè®¾ç½®çš„è®¿é—®ã€‚ Autodesk.Revit.UI.UIApplication æä¾›å¯¹åº”ç”¨ç¨‹åºçš„ UI çº§åˆ«ç•Œé¢çš„è®¿é—®ï¼ŒåŒ…æ‹¬å°† RibbonPanels æ·»åŠ åˆ°ç”¨æˆ·ç•Œé¢çš„èƒ½åŠ›ï¼Œä»¥åŠåœ¨ç”¨æˆ·ç•Œé¢ä¸­è·å–æ´»åŠ¨æ–‡æ¡£çš„èƒ½åŠ›ã€‚ Autodesk.Revit.ApplicationServices.Application æä¾›å¯¹æ‰€æœ‰å…¶ä»–åº”ç”¨ç¨‹åºçº§åˆ«å±æ€§çš„è®¿é—®ã€‚ è¯¥æ–‡æ¡£å¯¹è±¡æ˜¯ä»£è¡¨å»ºç­‘æ¨¡å‹çš„å•ä¸ª Revit é¡¹ç›®æ–‡ä»¶ Revit å¯ä»¥æ‰“å¼€å¤šä¸ªé¡¹ç›®ï¼Œå¹¶ä¸ºä¸€ä¸ªé¡¹ç›®æä¾›å¤šä¸ªè§†å›¾ã€‚ Autodesk.Revit.UI.UIDocument æä¾›å¯¹æ–‡æ¡£çš„ UI çº§åˆ«ç•Œé¢çš„è®¿é—®ï¼Œä¾‹å¦‚é€‰æ‹©å†…å®¹ä»¥åŠæç¤ºç”¨æˆ·è¿›è¡Œé€‰æ‹©å’Œé€‰æ‹©ç‚¹çš„åŠŸèƒ½ Autodesk.Revit.DB.Document æä¾›å¯¹æ‰€æœ‰å…¶ä»–æ–‡æ¡£çº§åˆ«å±æ€§çš„è®¿é—® æ€»ç»“ ä¸€æ¬¡å¯ä»¥æ‰“å¼€å¤šä¸ª Revit æ–‡æ¡£ï¼ˆåŒ…æ‹¬.rfa æ–‡ä»¶ï¼‰ï¼Œå› æ­¤éœ€è¦æŒ‡å®šè¦å®šä½çš„æ–‡æ¡£ã€‚ æ‚¨è¿˜å¯ä»¥å…·æœ‰å¤šä¸ª Revit åº”ç”¨ç¨‹åºçš„è¿è¡Œå®ä¾‹ï¼Œå› æ­¤æ‚¨éœ€è¦æŒ‡å®šè¦å®šä½çš„åº”ç”¨ç¨‹åºã€‚ Document / UIDocument å’Œ Application / UIApplication æ‹†åˆ†æ˜¯ç”± API è®¾è®¡äººå‘˜å†³å®šçš„ã€‚UI ç±»é€šå¸¸å¼•ç”¨ç”¨æˆ·ç•Œé¢å…ƒç´ æˆ–éœ€è¦äº¤äº’çš„å…ƒç´ ï¼ˆä¾‹å¦‚æç¤ºç”¨æˆ·åœ¨ä¸» Revit çª—å£ä¸­é€‰æ‹©å…ƒç´ ï¼‰ã€‚ ä¸»è¦è¦çŸ¥é“çš„æ˜¯ï¼Œæˆ‘ä»¬çš„æ ·æ¿ä»£ç ä¸­çš„ docï¼Œuidocï¼Œapp å’Œ uiapp å¥æŸ„å¯¹äºæ¶‰åŠç¼–è¾‘ Revit æ–‡æ¡£çš„è®¸å¤šæ“ä½œéƒ½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚ä¾‹å¦‚ï¼Œè¦åˆ é™¤æŸäº›å†…å®¹ï¼Ÿæ‚¨éœ€è¦å‚è€ƒè¦ä»ä¸­åˆ é™¤å†…å®¹çš„æ–‡æ¡£ï¼","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"2.4 å±•å¼€Revitå…ƒç´ ","slug":"PythonScriptPrimer/2.4 å±•å¼€Revitå…ƒç´ ","date":"2021-02-09T00:08:10.000Z","updated":"2021-02-08T20:34:04.771Z","comments":true,"path":"2021/02/09/PythonScriptPrimer/2.4 å±•å¼€Revitå…ƒç´ /","link":"","permalink":"https://zedmoster.github.io/2021/02/09/PythonScriptPrimer/2.4%20%E5%B1%95%E5%BC%80Revit%E5%85%83%E7%B4%A0/","excerpt":"","text":"About Unwrappingå±•å¼€å…ƒç´ ï¼Ÿç°åœ¨æœ‰ä¸€äº›å¥‡æ€ªçš„æœ¯è¯­ï¼ç®€è€Œè¨€ä¹‹ï¼šå¼•å…¥èŠ‚ç‚¹çš„ Revit å…ƒç´ åœ¨ä½¿ç”¨å‰éœ€è¦å…ˆâ€™unwrappedâ€™ã€‚ ä½†æ˜¯ä¸ºäº†äº†è§£æ‰€æœ‰å«ä¹‰ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ Dynamo çš„æœ€åˆå¼€å‘æ–¹å¼æœ‰ä¸€ç‚¹äº†è§£ã€‚ å›é¡¾å†å² ğŸ°Dynamo æœ€åˆè¢«è®¤ä¸ºæ˜¯ Ian Keough çš„å¼€æºçˆ±å¥½é¡¹ç›®ã€‚Dynamo æœ€åˆä»…ç”¨äºä¸ Revit é›†æˆï¼Œä½†å®ƒè¿˜éœ€è¦ Revit API æœ¬èº«ä¸æä¾›çš„æ‰©å±•åŠŸèƒ½ï¼Œä¾‹å¦‚å¯è§†åŒ–æŠ½è±¡å‡ ä½•ã€‚ å›´ç»•æ­¤é—®é¢˜çš„æ–¹æ³•æ˜¯ï¼ŒIan çš„æ–°åº”ç”¨ç¨‹åºä½¿ç”¨å…¶è‡ªå·±çš„ç­‰æ•ˆç±»å‹å®è´¨ä¸Šå°è£… Revit API ä¸­çš„å¤§çº¦ 1700 ä¸ªç±»-è¿™äº›ç±»å‹çš„åŠŸèƒ½å¯ä»¥æ ¹æ® Dynamo çš„è¦æ±‚è¿›è¡Œæ„å»ºã€‚ å› æ­¤ï¼ŒRevit çš„ç±»ä¸ Dynamo çš„ç­‰æ•ˆç±»ä¹‹é—´å­˜åœ¨ç»†å¾®ä¸”ä¸å¯å¯Ÿè§‰çš„å·®å¼‚ï¼ˆæ­¤ç±»ç±»ç§°ä¸ºâ€œåŒ…è£…å™¨ç±»â€ï¼‰ã€‚ å¦‚æœæˆ‘ä»¬æ£€æŸ¥ Revit å¯¹è±¡çš„ç±»åç§°åŠå…¶ç­‰æ•ˆçš„ Dynamo å¯¹è±¡ï¼Œåˆ™å¯ä»¥çœ‹åˆ°ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ Level å¯¹è±¡ï¼š åœ¨ Revit çš„ API ä¸­ï¼ŒLevel ç±»çš„å®Œå…¨é™å®šåç§°ä¸ºï¼šAutodesk.Revit.DB.Level åœ¨ Dynamo ä¸­ï¼ŒLevel ç±»çš„å®Œå…¨é™å®šåç§°ä¸ºï¼šRevit.Elements.Level ç¼–ç  ToRevitTypeé€šå¸¸ï¼ŒDynamo ä¼šå®Œæˆè¿™ä¸¤ä¸ªå·¥ä½œä¹‹é—´çš„æ‰€æœ‰å·¥ä½œï¼Œå³ä¸å¯è§åœ°åŒ…è£¹å’Œå±•å¼€åŒ…è£¹å…ƒç´ ã€‚é™¤äº†ç¼–å†™ä»£ç æ—¶ï¼Œæˆ‘ä»¬ä¸å¿…æ‹…å¿ƒå…·ä½“çš„æŠ€æœ¯ç»†èŠ‚ã€‚ åœ¨ç¼–å†™ IronPython è„šæœ¬æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå°†å…ƒç´ ä½œä¸ºè¾“å…¥æä¾›ç»™ Python è„šæœ¬èŠ‚ç‚¹ã€‚åœ¨æˆ‘ä»¬è§£å¼€å®ƒä»¬ä¹‹å‰ï¼Œè¿™äº›å…ƒç´ ä»å°†æ˜¯ Dynamo çš„â€åŒ…è£…â€ç±»å‹ã€‚åœ¨æˆ‘ä»¬è¿™æ ·åšä¹‹å‰ï¼ŒRevit çš„ç±»å‹å’Œ Dynamo çš„ç­‰æ•ˆç±»å‹ä¸èƒ½å¾ˆå¥½åœ°é…åˆä½¿ç”¨ã€‚ å±•å¼€å…ƒç´ éå¸¸ç®€å•ï¼Œå°±åƒè¿™æ ·ï¼š 123# ä½¿ç”¨ UnwrapElement() æ–¹æ³•# å°† Dynamo å…ƒç´ ç±»å‹è½¬æ¢ä¸º Revit å…ƒç´ ç±»å‹revitElements = UnwrapElement(IN[0]) æ³¨æ„ï¼š æœªèƒ½ä½¿ç”¨ UnwrapElement æœ¬èº«ä¸ä¼šå¼•å‘é”™è¯¯ï¼Œä½†æ˜¯åœ¨è¯»å–å±æ€§æˆ–ä½¿ç”¨åŒ…è£…ç±»å‹çš„æ–¹æ³•æ—¶ä¼šå‡ºé”™ã€‚ æ— éœ€æ€»æ˜¯è§£å¼€å…ƒç´  **UnwrapElement()**ï¼Œä»…å½“å®ƒä»¬ä» Python Script èŠ‚ç‚¹å¤–éƒ¨ä¼ å…¥æ—¶ä½¿ç”¨å³å¯ã€‚ ä¾‹å¦‚ï¼Œå½“ä½¿ç”¨ FilteredElementCollector æ”¶é›†å…ƒç´ æ—¶ï¼Œæˆ‘ä»¬å°†ç»•è¿‡ Dynamo å¹¶ç›´æ¥ä¸ Revit çš„ API è·å–æ•°æ®ï¼Œè¯¥ API å°† Revit çš„æœ¬èº«ç±»å‹è¿”å›ç»™æˆ‘ä»¬ï¼Œæ‰€ä»¥ä¸éœ€è¦è§£å¼€å…ƒç´ ï¼","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"2.2 å¦‚ä½•é˜…è¯»Revitçš„APIæ–‡æ¡£","slug":"PythonScriptPrimer/2.2 å¦‚ä½•é˜…è¯»Revitçš„APIæ–‡æ¡£","date":"2021-02-09T00:08:09.000Z","updated":"2021-02-08T20:33:14.134Z","comments":true,"path":"2021/02/09/PythonScriptPrimer/2.2 å¦‚ä½•é˜…è¯»Revitçš„APIæ–‡æ¡£/","link":"","permalink":"https://zedmoster.github.io/2021/02/09/PythonScriptPrimer/2.2%20%E5%A6%82%E4%BD%95%E9%98%85%E8%AF%BBRevit%E7%9A%84API%E6%96%87%E6%A1%A3/","excerpt":"","text":"ä½¿ç”¨ APIDocs.Coç”±äºè¯¥ç½‘ç«™å¯¹äºå¸Œæœ›ç†Ÿæ‚‰ Revit API çš„äººæ¥è¯´æ˜¯éå¸¸å®è´µçš„èµ„æºï¼Œå› æ­¤æˆ‘ä»¬æä¾›äº†ä½¿ç”¨è¯¥ç½‘ç«™çš„ç®€è¦æŒ‡å—ã€‚ å…¸å‹çš„å·¥ä½œæµç¨‹å°†æ¶‰åŠç¡®ä¿å·²ä¸ºè¦ä½¿ç”¨çš„äº§å“é€‰æ‹©åˆé€‚ç‰ˆæœ¬çš„ APIï¼ˆåœ¨å·¦çª—æ ¼ä¸­ï¼‰ï¼Œç„¶ååœ¨ API æ–‡æ¡£ä¸­æœç´¢æ‚¨å…³æ³¨çš„ç›¸å…³ä¸»é¢˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦äº†è§£æœ‰å…³ FamilyInstance ç±»çš„æ›´å¤šä¿¡æ¯ï¼Œåªéœ€åœ¨æœç´¢æ ä¸­æœç´¢å®ƒï¼Œç„¶åä»è‡ªåŠ¨å®Œæˆé€‰é¡¹ä¸­é€‰æ‹©å®ƒå³å¯ã€‚ç„¶åï¼Œæœ‰å…³æ­¤ç±»çš„è¯¦ç»†ä¿¡æ¯å°†æ˜¾ç¤ºåœ¨å³ä¾§çš„è¯¦ç»†ä¿¡æ¯çª—æ ¼ä¸­ï¼š è¿™æ˜¯æ‚¨æ­£åœ¨æŸ¥çœ‹çš„é¡µé¢çš„åç§°ã€‚Revit API æœ‰è¶…è¿‡ 22,000 é¡µï¼Œä½†å…¶ä¸­çš„å¤§éƒ¨åˆ†éƒ½æ˜¯ä¸ç»å¸¸ä½¿ç”¨çš„ï¼ è¿™ä¸ª &lt;&gt; æŒ‰é’®å°†åœ¨å‡ ä¸ªæµè¡Œçš„ Github å­˜å‚¨åº“ä¸­æœç´¢æœ‰å…³è¯¥ç±»çš„ä»»ä½•ä»£ç ç¤ºä¾‹ã€‚ Members å°†å¸¦æ‚¨åˆ°æ˜¾ç¤ºè¯¥ç±»çš„æ‰€æœ‰æ–¹æ³•ï¼Œå±æ€§ï¼Œæ¥å£æˆ–æ„é€ å‡½æ•°çš„æ•´ä¸ªé¡µé¢ã€‚ é¢å‘å¯¹è±¡ç¼–ç¨‹Members: ç±»çš„æˆå‘˜é¡µé¢åªæ˜¯å°†å…¶æ‰€æœ‰æ–¹æ³•ï¼Œå±æ€§ç­‰æ”¶é›†åœ¨ä¸€ä¸ªé¡µé¢ä¸Šã€‚å¦‚æœä¸ç¡®å®šæŸä¸ªç±»æ˜¯å¦å…·æœ‰ç‰¹å®šåŠŸèƒ½ï¼Œè¿™å°†éå¸¸æœ‰ç”¨ã€‚ Methods: ç±»æ–¹æ³•æ˜¯å®ƒå¯ä»¥è¿è¡Œçš„åŠŸèƒ½ã€‚å¯ä»¥å°†å®ƒä»¬è§†ä¸ºåŠ¨è¯ do something çš„å®ä¾‹å¯ä»¥åšä»€ä¹ˆã€‚ä¾‹å¦‚ï¼ŒFamilyInstance ç±»å‹çš„å¯¹è±¡å…·æœ‰ flipHand() æ–¹æ³•ï¼Œå¯è®©æ‚¨ç¿»è½¬å…¶å¤„ç†æ–¹å¼ã€‚ 12# å¯æ˜¯ä½¿ç”¨ flipHand ç¿»è½¬ my_family_instance å®ä¾‹å¯¹è±¡my_family_instance.flipHand() æ³¨æ„ï¼šå¯¹ Revit æ–‡æ¡£æ‰€åšçš„ä»»ä½•æ›´æ”¹éƒ½å¿…é¡»åœ¨å¼€å§‹äº‹åŠ¡ Transaction . Properties: å±æ€§æ›´åƒæ˜¯ç±»çš„â€å½¢å®¹è¯â€ï¼Œå¯å¸®åŠ©æ‚¨äº†è§£æœ‰å…³è¯¥ç±»ç‰¹å®šå¯¹è±¡ï¼ˆå³å®ä¾‹ï¼‰çš„æ›´å¤šçŠ¶æ€ã€‚ä¾‹å¦‚ï¼ŒFamilyInstance ç±»å…·æœ‰ä¸€ä¸ª HandFlipped å±æ€§ï¼Œå¯ä»¥æŸ¥è¯¢è¯¥å±æ€§çš„å€¼ï¼Œååº”äº†è¯¥ç‰¹å®šå®ä¾‹çš„æ˜¯å¦å·²ç¿»è½¬ã€‚ 12# è¿™å°†è¿”å›Trueæˆ–Falseï¼Œå…·ä½“å–å†³äºå¯¹è±¡æ˜¯å¦ç¿»è½¬is_it_handflipped = my_family_instance.HandFlipped Constructors: API ä¸­çš„æ„é€ å‡½æ•°å®é™…ä¸Šæ˜¯åœ¨å‘Šè¯‰æ‚¨å¦‚ä½•åˆ›å»ºç±»çš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼ŒXYZ ç±»ç”¨äºåœ¨ Revit ä¸­å®šä¹‰ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶æ„é€ å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12# åˆ›å»ºä¸€ä¸ªæ–°çš„ç‚¹my_point = XYZ(0,0,0) æ³¨æ„ï¼šä¸ Dynamo ä¸åŒçš„æ˜¯ Revit åˆ›å»ºçš„å‡ ä½•å¯¹è±¡æ˜¯ä¸å¯è§çš„ Enumerations: è¿™äº›ä¹Ÿç§°ä¸ºæšä¸¾ï¼Œå®ƒä»¬æ˜¯ç¡¬ç¼–ç çš„åˆ—è¡¨ï¼Œé€šå¸¸ä¸æ‰“ç®—æ›´æ”¹å¹¶ä¸”å°†é€‰æ‹©é™åˆ¶ä¸ºä¸€ç»„é€‰é¡¹ã€‚äº¤é€šä¿¡å·ç¯çŠ¶æ€çš„æšä¸¾åº”ç±»ä¼¼äºï¼š Red Yellow Green å› æ­¤ï¼Œç”¨æˆ·åˆ›å»ºçš„ä»»ä½•äº¤é€šä¿¡å·ç¯å¯¹è±¡éƒ½éœ€è¦å°†å…¶äº¤é€šä¿¡å·ç¯çŠ¶æ€è®¾ç½®ä¸ºè½¯ä»¶ä¾›åº”å•†å®šä¹‰çš„é¢„å†™çŠ¶æ€ä¹‹ä¸€ã€‚æ‚¨å¯ä»¥é€‰æ‹©æšä¸¾å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12# enumæšä¸¾ä¸­çš„ä¸€ç§é¢„å®šä¹‰çŠ¶æ€traffic_light_value = TrafficLightState.Green Revit API ä¸­çš„ä¸€äº›å…³é”®çš„æšä¸¾ç±»å‹ï¼š BuiltInCategory : ç±»å‹ BuiltInParameter : å‚æ•° DisplayUnitType : å•ä½","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"2.1 Revit APIç®€ä»‹","slug":"PythonScriptPrimer/2.1 Revit APIç®€ä»‹","date":"2021-02-09T00:08:08.000Z","updated":"2021-02-08T20:32:46.675Z","comments":true,"path":"2021/02/09/PythonScriptPrimer/2.1 Revit APIç®€ä»‹/","link":"","permalink":"https://zedmoster.github.io/2021/02/09/PythonScriptPrimer/2.1%20Revit%20API%E7%AE%80%E4%BB%8B/","excerpt":"","text":"Revit API ç®€ä»‹Revit è‡ª 2000 å¹´ä»£åˆä»¥æ¥å°±å…·æœ‰å¯è®¿é—®çš„ APIï¼Œå¯ç”¨äºé©±åŠ¨è¯¥è½¯ä»¶çš„å‡ ä¹æ¯ä¸ªæ–¹é¢ã€‚ç”±äº Revit åº”ç”¨ç¨‹åºéå¸¸å¤æ‚ï¼Œå¹¶ä¸”æ»¡è¶³å¤šä¸“ä¸šåŠŸèƒ½éœ€æ±‚ï¼ˆå»ºç­‘ç»“æ„ï¼ŒMEP ç­‰ï¼‰ï¼Œå› æ­¤å®ƒçš„ API éå¸¸å¤§ä¸”éœ€è¦ä¸€æ®µæ—¶é—´æ‰èƒ½ç›´è§‚åœ°ç†è§£ä¹Ÿå°±ä¸è¶³ä¸ºå¥‡äº†ã€‚ æˆ‘ç»å¸¸å‘ç°æœ€å®¹æ˜“æƒ³åˆ° Revit ä¸»è¦æ˜¯ä¸€ä¸ªæ•°æ®åº“ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨è¯¥åº”ç”¨ç¨‹åºæ—¶ä¼šä¸æ–­å¯¹å…¶è¿›è¡Œæ›´æ–°ã€‚æ•°æ®åº“å­˜å‚¨æˆ‘ä»¬çš„å†…å®¹ï¼ˆå…¶å…ƒç´  IDï¼Œç±»åˆ«ï¼Œä½ç½®ç­‰ï¼‰ã€‚åœ¨æ­¤ä¹‹ä¸Šæ˜¯ GUIï¼Œå®ƒè¡¨ç¤º 3D ç©ºé—´ä¸­å…ƒç´ çš„å‡ ä½•å½¢çŠ¶/ä½ç½®ï¼Œå¹¶è®©æˆ‘ä»¬ä¸å…ƒç´ è¿›è¡Œäº¤äº’ã€‚ æœ€åï¼Œè¿˜æœ‰ä¸€ç‚¹ç½‘ç»œé­”æœ¯å¯ä»¥ä½¿æˆ‘ä»¬è·¨å±€åŸŸç½‘/ Revit Server / BIM360 è®¾ç½®å·¥ä½œå…±äº«ã€‚ ä»¥è¿™ç§æ–¹å¼æ€è€ƒ Revit ä¸å¤§å¤šæ•°ç”¨æˆ·ä½“éªŒè¯¥è½¯ä»¶çš„æ–¹å¼å®Œå…¨ä¸åŒã€‚å®é™…ä¸Šï¼Œå½“æˆ‘ä»¬é’ˆå¯¹ Revit çš„ API ç¼–å†™è„šæœ¬æ—¶ï¼Œæˆ‘ä»¬åªæ˜¯å¯¹æ•°æ®åº“è¿›è¡Œäº†ä¸€ç³»åˆ—è°ƒç”¨ï¼Œå—è¯¥ API è§„åˆ™çš„çº¦æŸã€‚ ç‰ˆæœ¬å’Œå†å²å¯¹äº Revit çš„æ¯ä¸ªå‘è¡Œç‰ˆå’Œå­å‘è¡Œç‰ˆï¼ŒAutodesk Revit å›¢é˜Ÿéƒ½ä¼šå¯¹å…¶ API è¿›è¡Œè¾ƒå°çš„æ›´æ–°æˆ–æ·»åŠ ã€‚è¿™äº›æ›´æ”¹ä¸»è¦ä¸è½¯ä»¶æœ¬èº«çš„åŠŸèƒ½æ›´æ”¹æœ‰å…³ã€‚ Revit SDK &amp; API æ–‡æ¡£è½¯ä»¶å¼€å‘å¥—ä»¶ï¼ˆSDKï¼‰æ˜¯è½¯ä»¶ä¾›åº”å•†å‘å¼€å‘äººå‘˜åˆ†å‘æœ‰å…³å…¶ API çš„ä¿¡æ¯çš„ä¸€ç§å¸¸ç”¨æ–¹æ³•ã€‚å¯ä»¥åœ¨æ‰¾åˆ°å®˜æ–¹çš„ Revit SDK ã€‚ å®˜æ–¹ SDK ç‚¹å‡»ä¸‹è½½ æ‰€æœ‰ API éƒ½éœ€è¦æŠ€æœ¯æ–‡æ¡£ï¼Œå› æ­¤ç¨‹åºå‘˜å¯ä»¥é€‰æ‹©å®ƒä»¬å¹¶å­¦ä¹ å¦‚ä½•ä½¿ç”¨ä»£ç æ¥é©±åŠ¨åº”ç”¨ç¨‹åºã€‚Revit SDK åŒ…å«.chm æ–‡ä»¶ä¸­çš„å®˜æ–¹ API æ–‡æ¡£ä»¥åŠä»£ç ç¤ºä¾‹ï¼ˆç”¨ Visual Basic å’Œ Cï¼ƒç¼–å†™ï¼‰ã€‚ ä½†æ˜¯ï¼Œæœ¬æŒ‡å—å»ºè®®é˜…è¯» APIDocs.co ç½‘ç«™ä¸Šçš„ Revit API ï¼Œè¿™æ¯”æ‰“å¼€ .chm æ–‡ä»¶æ–¹ä¾¿è®¸å¤šã€‚ APIDocs.co","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"1.3 åŸºæœ¬ï¼šè¾“å…¥å’Œè¾“å‡º","slug":"PythonScriptPrimer/1.3 åŸºæœ¬ï¼šè¾“å…¥å’Œè¾“å‡º","date":"2021-02-08T12:05:00.000Z","updated":"2021-02-08T12:14:10.913Z","comments":true,"path":"2021/02/08/PythonScriptPrimer/1.3 åŸºæœ¬ï¼šè¾“å…¥å’Œè¾“å‡º/","link":"","permalink":"https://zedmoster.github.io/2021/02/08/PythonScriptPrimer/1.3%20%E5%9F%BA%E6%9C%AC%EF%BC%9A%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA/","excerpt":"è¾“å…¥å’Œè¾“å‡ºIN å’Œ OUT æ˜¯ Dynamo çš„ Python èŠ‚ç‚¹ä¸­çš„é‡è¦å…³é”®å­—ã€‚IN å…³é”®å­—å‘Šè¯‰èŠ‚ç‚¹å¼•ç”¨é€šè¿‡å…¶è¾“å…¥å‘é€åˆ°èŠ‚ç‚¹çš„ä»»ä½•æ•°æ®ã€‚ æ³¨æ„ï¼šåé¢æ‰€æœ‰çš„ç¨‹åºä»£ç å‡è¿è¡Œåœ¨æ¨¡æ¿æ–‡ä»¶ä»£ç å—å†…","text":"è¾“å…¥å’Œè¾“å‡ºIN å’Œ OUT æ˜¯ Dynamo çš„ Python èŠ‚ç‚¹ä¸­çš„é‡è¦å…³é”®å­—ã€‚IN å…³é”®å­—å‘Šè¯‰èŠ‚ç‚¹å¼•ç”¨é€šè¿‡å…¶è¾“å…¥å‘é€åˆ°èŠ‚ç‚¹çš„ä»»ä½•æ•°æ®ã€‚ æ³¨æ„ï¼šåé¢æ‰€æœ‰çš„ç¨‹åºä»£ç å‡è¿è¡Œåœ¨æ¨¡æ¿æ–‡ä»¶ä»£ç å—å†… é€šè¿‡å®ƒä»¬çš„ç´¢å¼•å¯ä»¥è®¿é—®å„ç§è¾“å…¥ï¼Œä¾‹å¦‚ä¸‹é¢çš„ list_of_numbersï¼š 12345678input_list_of_numbers = IN[0] # è·å–å¤–éƒ¨èŠ‚ç‚¹è¾“å…¥output_list_of_numbers = [] # åˆ›å»ºç©ºåˆ—è¡¨ä½œä¸ºè¾“å‡ºçš„å†…å®¹for number in input_list_of_numbers: new_number = number + 1 output_list_of_numbers.append(new_number)OUT = output_list_of_numbers # è¾“å‡ºæ–°çš„åˆ—è¡¨å†…å®¹ï¼ˆä¼ å…¥çš„å€¼æ¯ä¸ªæ•°å­—å‡è¿›è¡Œ +1 æ“ä½œï¼‰ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æœ€åˆä¸ºè¾“å‡ºåˆ›å»ºä¸€ä¸ªç©ºåˆ—è¡¨ã€‚æˆ‘ä»¬éå†è¾“å…¥åˆ—è¡¨ä¸­çš„æ¯ä¸ªæ•°å­—ï¼Œå¹¶å°†å…¶è¿›è¡Œ +1 æ“ä½œåæ·»åŠ åˆ°æˆ‘ä»¬åˆ›å»ºçš„è¾“å‡ºåˆ—è¡¨ä¸­ã€‚æœ€åï¼Œé€šè¿‡ OUT å…³é”®å­—è¾“å‡ºåˆ—è¡¨ã€‚ å®é™…ä¸Šï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š è¾“å…¥å’Œè¾“å‡ºçš„ç±»å‹Dynamo èŠ‚ç‚¹å¯ä»¥å°†ä»»ä½•ç§ç±»çš„æ•°æ®ä½œä¸ºè¾“å…¥ï¼Œå¹¶å¯ä»¥è¾“å‡ºä»»ä½•ç§ç±»çš„æ•°æ®ä½œä¸ºè¾“å‡ºã€‚ å®ƒèƒ½å¤Ÿå°†å…ƒç´ ï¼ˆä¾‹å¦‚ Revit å…ƒç´ ï¼‰ï¼ŒæŠ½è±¡æ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼ŒDynamo å‡ ä½•å›¾å½¢ä»¥åŠå…¶ä»–æ‰€æœ‰å†…å®¹ä½œä¸ºè¾“å…¥ã€‚ ä½†æ˜¯ï¼Œå°† Revit å…ƒç´ è¾“å…¥åˆ° Python èŠ‚ç‚¹æ—¶æœ‰ä¸€ä¸ªè­¦å‘Šã€‚ Revit å…ƒç´ éœ€è¦è¿›è¡Œè½¬æ¢ç±»å‹åï¼Œæ‰èƒ½é€šè¿‡ API è¿›è¡Œè®¿é—®ã€‚ äº†è§£ Dynamo Revit æ•°æ®ç±»å‹è½¬æ¢","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"1.2 æ ·æ¿ä»£ç è®¾ç½®","slug":"PythonScriptPrimer/1.2 æ ·æ¿ä»£ç è®¾ç½®","date":"2021-02-08T12:00:50.000Z","updated":"2021-02-08T12:12:54.275Z","comments":true,"path":"2021/02/08/PythonScriptPrimer/1.2 æ ·æ¿ä»£ç è®¾ç½®/","link":"","permalink":"https://zedmoster.github.io/2021/02/08/PythonScriptPrimer/1.2%20%E6%A0%B7%E6%9D%BF%E4%BB%A3%E7%A0%81%E8%AE%BE%E7%BD%AE/","excerpt":"æ ·æ¿ä»£ç è®¾ç½®å¤åˆ¶ä»£ç æ–‡ä»¶åˆ°æœ¬åœ°ä¿å­˜ä¸º RevitApi.py","text":"æ ·æ¿ä»£ç è®¾ç½®å¤åˆ¶ä»£ç æ–‡ä»¶åˆ°æœ¬åœ°ä¿å­˜ä¸º RevitApi.py 1234567891011121314151617181920212223242526272829303132333435import clrimport syssys.path.append(&#x27;C:\\Program Files (x86)\\IronPython 2.7\\Lib&#x27;)import Systemfrom System import Arrayfrom System.Collections.Generic import *clr.AddReference(&#x27;ProtoGeometry&#x27;)from Autodesk.DesignScript.Geometry import *clr.AddReference(&quot;RevitNodes&quot;)import Revitclr.ImportExtensions(Revit.Elements)clr.ImportExtensions(Revit.GeometryConversion)clr.AddReference(&quot;RevitServices&quot;)import RevitServicesfrom RevitServices.Persistence import DocumentManagerfrom RevitServices.Transactions import TransactionManagerclr.AddReference(&quot;RevitAPI&quot;)clr.AddReference(&quot;RevitAPIUI&quot;)import Autodeskfrom Autodesk.Revit.DB import *from Autodesk.Revit.UI import *doc = DocumentManager.Instance.CurrentDBDocumentuiapp = DocumentManager.Instance.CurrentUIApplicationapp = uiapp.Applicationuidoc = uiapp.ActiveUIDocumentTransactionManager.Instance.EnsureInTransaction(doc) # äº‹åŠ¡å¼€å§‹####### é€»è¾‘ä»£ç  ########TransactionManager.Instance.TransactionTaskDone() # äº‹åŠ¡ç»“æŸOUT = doc Python Script æ ·æ¿æ–‡ä»¶Dynamo 2.0 å¼€å§‹,å¼•å…¥ Python è„šæœ¬æ¨¡æ¿ã€‚é»˜è®¤åº”ç”¨å˜é‡ä¼šè‡ªåŠ¨æ·»åŠ åˆ° Python Script èŠ‚ç‚¹ å¤åˆ¶æ–‡ä»¶RevitBoilerplate.pyåˆ°ä½ç½®ä½äº Dynamo å®‰è£…çš„ APPDATA ä½ç½®ã€‚ è·¯å¾„ï¼š%appdata%\\Dynamo\\Dynamo Revit\\{version}\\ ä¿®æ”¹æ–‡ä»¶DynamoSettings.xmlä¸­çš„ PythonTemplateFilePath å†…å®¹ 123&lt;PythonTemplateFilePath&gt; C:\\Users\\&#123;USERNAME&#125;\\AppData\\Roaming\\Dynamo\\Dynamo Revit\\&#123;version&#125;\\RevitBoilerplate.py&lt;/PythonTemplateFilePath&gt; å®Œæˆä¸Šé¢çš„è®¾ç½®ä¹‹åã€‚å°±å¯ä»¥ä½¿ç”¨ Dynamo æ„‰å¿«ç¼–å†™ python è„šæœ¬æ“æ§ Revit è½¯ä»¶ï¼","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]},{"title":"1.1 Dynamo's Pythonç¼–è¾‘å™¨","slug":"PythonScriptPrimer/1.1 Dynamo's Pythonç¼–è¾‘å™¨","date":"2021-02-08T11:49:51.000Z","updated":"2021-02-08T12:12:41.712Z","comments":true,"path":"2021/02/08/PythonScriptPrimer/1.1 Dynamo's Pythonç¼–è¾‘å™¨/","link":"","permalink":"https://zedmoster.github.io/2021/02/08/PythonScriptPrimer/1.1%20Dynamo's%20Python%E7%BC%96%E8%BE%91%E5%99%A8/","excerpt":"Dynamo çš„ Python è„šæœ¬ç¼–è¾‘å™¨Python è„šæœ¬èŠ‚ç‚¹éš Dynamo ä¸€èµ·å®‰è£…ï¼Œå¹¶ä¸”åœ¨è®¸å¤šæ–¹é¢ï¼Œå®ƒä¸ä»»ä½•å…¶ä»–èŠ‚ç‚¹ä¸€æ ·ï¼šå¯ä»¥æ”¾ç½®åœ¨å·¥ä½œç©ºé—´ä¸­ï¼Œé‡å‘½åå¹¶å¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„è¾“å…¥ã€‚","text":"Dynamo çš„ Python è„šæœ¬ç¼–è¾‘å™¨Python è„šæœ¬èŠ‚ç‚¹éš Dynamo ä¸€èµ·å®‰è£…ï¼Œå¹¶ä¸”åœ¨è®¸å¤šæ–¹é¢ï¼Œå®ƒä¸ä»»ä½•å…¶ä»–èŠ‚ç‚¹ä¸€æ ·ï¼šå¯ä»¥æ”¾ç½®åœ¨å·¥ä½œç©ºé—´ä¸­ï¼Œé‡å‘½åå¹¶å¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„è¾“å…¥ã€‚ ä½†æ˜¯ï¼Œä¸å…¶ä»–èŠ‚ç‚¹ä¸åŒï¼Œå¦‚æœå³é”®å•å‡»å¹¶é€‰æ‹© Edit.. åˆ™ä¼šå‡ºç°ä¸€ä¸ªè„šæœ¬ç¼–è¾‘çª—å£(åŒå‡»èŠ‚ç‚¹)ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š åœ¨æ­¤çª—å£ä¸­ï¼Œæ‚¨å¯ä»¥ç¼–å†™ IronPython è„šæœ¬ï¼Œè¿™äº›è„šæœ¬å°†ä½œä¸º Dynamo å®šä¹‰çš„ä¸€éƒ¨åˆ†ç›´æ¥æ‰§è¡Œã€‚è¦ä¿å­˜è„šæœ¬ï¼Œè¯·å•å‡» ä¿å­˜æ›´æ”¹ æŒ‰é’®ï¼Œç„¶åä¿å­˜å…¶ä¸­çš„ Dynamo å®šä¹‰ã€‚å¦åˆ™ï¼Œè¯·å•å‡»â€œå–æ¶ˆâ€æŒ‰é’®ä»¥æ”¾å¼ƒæ‰€åšçš„ä»»ä½•æ›´æ”¹ã€‚ å¦‚ä½•ç¼–å†™ç¨‹åºä½¿ç”¨ Dynamo ç¼–å†™ Python ä»£ç ï¼åé¢ä¼šå­¦ä¹ è®¾ç½®æ ·æ¿ä»£ç ï¼Œå¼•ç”¨ Revit Apiã€‚ dynamo æ‰‹å†Œ","categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]}],"categories":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/categories/dynamo/"}],"tags":[{"name":"dynamo","slug":"dynamo","permalink":"https://zedmoster.github.io/tags/dynamo/"},{"name":"python","slug":"python","permalink":"https://zedmoster.github.io/tags/python/"}]}